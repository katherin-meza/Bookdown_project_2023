[["index.html", "My Bookdown Research and analysis", " My Bookdown Katherin Meza 2023-04-13 Research and analysis "],["research-description.html", "Step 1 Research description 1.1 Context of the following analysis", " Step 1 Research description 1.1 Context of the following analysis #First Chapter of thesis dissertation: &quot;Exploring the sustainability of forage-based fallows in Peruvian Andean agriculture systems&quot; # In this study, the percentage of Soil total carbon was considered as one indicator to determine sustainability # I used the Daily Century ecosystem model(DayCent)(Hartman, 2018; Parton, 1996). This model was used to estimate the long-term soil C dynamics by treatment and each field locations after the introduction of forage-based fallow (tentative agro-ecological practice) within the Andean crop rotation. #This model has its own interface, which use several parameters to calculate the soil total carbon, for instance, historical soil managements, weather data, soil properties, crop rotation management, etc). # In term of historical data, this model used three scenarios to perform the equilibrium: 1. natural condition which was run for 8000 year, 2. the most common 6 year crop base rotation which was run for 200 year, and 3. current 6 crop rotation + tentative agro-ecological practice rotation which was run for 300 years. # Regarding to the tentative agro-ecological practice, it was expressed as four treatments called: 1. &quot;Traditional_fallow&quot; (control), 2. &quot;Annual fallow&quot;, 3. &quot;Perennial fallow&quot;, and 4.&quot;Alfalfa fallow&quot;. #Daycent outcomes is given per month across across 8000 year (natural conditions), 200 year (common crop rotation), and the last 300 year which account for the effect of the agro-ecological practice). #For the purpose of this study, I used the last 300 years (crop-agroecological practice). From this time frame, I only extracted data from the first 50 years to analysis the percentage of total soil carbon trend across each agro-ecological practice (treatment). "],["extraction-and-analysis-of-the-data-set.html", "Step 2 Extraction and analysis of the data set 2.1 Setting working directory 2.2 Using modeling and coding approach 2.3 Re-analyzing data with transformed values (sqrt)", " Step 2 Extraction and analysis of the data set library(tidyverse) # Package with dplyr, tibble, readr, and others to help clean coding library(dataRetrieval) # Package to download data library(sf) # Geospatial package to plot and explore data library(mapview) # Simple interface to leaflet interactive maps library(broom) # Simplifies model outputs library(knitr) # Makes nice tables library(kableExtra) # Makes even nicer tables library(lubridate) # Makes working with dates easier library(ggthemes) # Makes plots prettier library(tidyr) # Makes multiple simultaneous models easier library(trend) # Allows us to explore trends library(data.table) #Allows to import files quickly and conveniently library(lmerTest) library(emmeans) library(multcompView) library(multcomp) 2.1 Setting working directory #Setting working directory setwd((&quot;D:/D/DISCPO D/CSU/PHD 2023_SPRING/Enviromental data analysis/Final-Project-Submission/Carbon_trend_project&quot;)) #Binding 5 data set, each one correspond to each field, each one with four treatments (&quot;Traditional_fallow&quot; (control), 2. &quot;Annual fallow&quot;, 3. &quot;Perennial fallow&quot;, and 4.&quot;Alfalfa fallow&quot;) files&lt;-list.files(pattern = &quot;.csv&quot;) temp&lt;-lapply(files, fread, sep =&quot;,&quot;) data&lt;- rbindlist(temp, fill=TRUE) write.csv(data, file =&quot;Alldataset_carbon_stocks.csv&quot;) #Calling complete data set Carbon_trends &lt;- read.csv(&quot;D:/D/DISCPO D/CSU/PHD 2023_SPRING/Enviromental data analysis/Final-Project-Submission/Carbon_trend_project/Alldataset_carbon_stocks.csv&quot;) Carbon_trends$year&lt;- as.factor(Carbon_trends$year) #Column year customized as factor str(Carbon_trends) ## &#39;data.frame&#39;: 8640 obs. of 18 variables: ## $ X : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.1 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.2 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.3 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.4 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.5 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.6 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.7 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.8 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.9 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.10 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.11 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ Field : chr &quot;Dionisio&quot; &quot;Dionisio&quot; &quot;Dionisio&quot; &quot;Dionisio&quot; ... ## $ Treatment: chr &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; ... ## $ year : Factor w/ 36 levels &quot;2015&quot;,&quot;2016&quot;,..: 1 2 3 4 5 6 7 8 9 10 ... ## $ pctC : num 2.75 2.64 2.62 2.58 2.57 ... ## $ V6 : chr &quot;&quot; &quot;&quot; &quot;&quot; &quot;first cycle&quot; ... 2.2 Using modeling and coding approach # In order to understand the effect of agro-ecological practices (4 treatments) on the soil total carbon (%) after each 6 years of crop+treatments rotations. Data will be filter from 2020 to 2048 year time frame. #Assessing for normality with Shapiro test #Nesting data by year due to we want compere emmeans after 6 years of crop-agroecological practice rotation across 50 years nesting_data_SE&lt;- Carbon_trends%&gt;% filter(year %in% c(2020,2026,2032,2038, 2044,2048))%&gt;% #every 6 years group_by(year)%&gt;% nest() head(nesting_data_SE) ## # A tibble: 6 × 2 ## # Groups: year [6] ## year data ## &lt;fct&gt; &lt;list&gt; ## 1 2020 &lt;tibble [240 × 17]&gt; ## 2 2026 &lt;tibble [240 × 17]&gt; ## 3 2032 &lt;tibble [240 × 17]&gt; ## 4 2038 &lt;tibble [240 × 17]&gt; ## 5 2044 &lt;tibble [240 × 17]&gt; ## 6 2048 &lt;tibble [240 × 17]&gt; #Defining a function to fit the linear mixed model and perform the Shapiro-Wilk test on the residuals for each year: fit_lm_normality&lt;-function(df=nesting_data_SE){ options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;)) mod&lt;-lmer(pctC~Treatment+(1|Field), data = df) shapiro_test&lt;-shapiro.test(residuals(mod)) tibble(group = unique(df$year), lmm_result = list(mod), shapiro_wilk_statistic = shapiro_test$statistic, shapiro_wilk_p_value = shapiro_test$p.value) } #Unnesting data tidy_norm&lt;-nesting_data_SE%&gt;% mutate(results = map(data,fit_lm_normality))%&gt;% unnest(results) #Based on the Shapiro analysis our data is not normal distributed 2.3 Re-analyzing data with transformed values (sqrt) #Transforming values and grouping and nesting by Year nesting_data_with_transf&lt;- Carbon_trends%&gt;% mutate(sqr=sqrt(pctC))%&gt;% filter(year %in% c(2020,2026,2032,2038, 2044,2048))%&gt;% #Every 6 years crop rotation group_by(year)%&gt;% nest() head(nesting_data_with_transf) ## # A tibble: 6 × 2 ## # Groups: year [6] ## year data ## &lt;fct&gt; &lt;list&gt; ## 1 2020 &lt;tibble [240 × 18]&gt; ## 2 2026 &lt;tibble [240 × 18]&gt; ## 3 2032 &lt;tibble [240 × 18]&gt; ## 4 2038 &lt;tibble [240 × 18]&gt; ## 5 2044 &lt;tibble [240 × 18]&gt; ## 6 2048 &lt;tibble [240 × 18]&gt; #Creating the function for the MODEL fit_lm_anova_SE&lt;-function(df=nesting_data_with_transf[[1]]){ options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;)) mod&lt;-lmer(sqr~Treatment+(1|Field), data = df) Anova&lt;-anova(mod, ddf=&quot;Kenward-Roger&quot;) } #Tiding and unnesting the model tidy_ANOVA_SE&lt;-nesting_data_with_transf%&gt;% mutate(tidy_mod = map(data,fit_lm_anova_SE))%&gt;% unnest(tidy_mod) view(tidy_ANOVA_SE) #we can use .key=&quot;rename data columns&quot; #summarize(Carbon = mean(sqr, na.rm = T))%&gt;% "],["graph-over-50-years.html", "Step 3 Graph over 50 years 3.1 Graphing percentage of total soil carbon over 50 years", " Step 3 Graph over 50 years 3.1 Graphing percentage of total soil carbon over 50 years #Summarizing data set summary_C&lt;- Carbon_trends%&gt;% group_by(Treatment, year)%&gt;% summarise( n=n(), mean=mean(pctC), sd=sd(pctC), se=sd/sqrt(n)) summary_C ## # A tibble: 144 × 6 ## # Groups: Treatment [4] ## Treatment year n mean sd se ## &lt;chr&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Alfalfa fallow 2015 60 1.85 0.498 0.0643 ## 2 Alfalfa fallow 2016 60 1.83 0.459 0.0592 ## 3 Alfalfa fallow 2017 60 1.79 0.462 0.0597 ## 4 Alfalfa fallow 2018 60 1.76 0.445 0.0575 ## 5 Alfalfa fallow 2019 60 1.76 0.438 0.0565 ## 6 Alfalfa fallow 2020 60 2.06 0.382 0.0494 ## 7 Alfalfa fallow 2021 60 2.00 0.385 0.0497 ## 8 Alfalfa fallow 2022 60 1.92 0.366 0.0473 ## 9 Alfalfa fallow 2023 60 1.87 0.368 0.0475 ## 10 Alfalfa fallow 2024 60 1.85 0.359 0.0464 ## # … with 134 more rows #Graph Carbon trends data_new &lt;- summary_C # Duplicate data levels(data_new$Treatment) &lt;- list(&quot;Alfalfa&quot; = &quot;Alfalfa fallow&quot;, # Change factor levels &quot;Annual&quot; = &quot;Annual fallow&quot;, &quot;Perennial&quot; = &quot;Perennial fallow&quot;, &quot;Traditional&quot; = &quot;Traditional_fallow&quot;) C_con_EROD&lt;-ggplot(data_new, aes(year, mean,group=Treatment, color=Treatment)) + xlab(&quot;&quot;) + ylab(&quot;% Soil total carbon&quot;)+ geom_line() + geom_point(size=1)+ # scale_shape_discrete(name=&quot;Fallow type&quot;, # breaks=c(&quot;Alfalfa fallow&quot;,&quot;Annual fallow&quot;, &quot;Perennial fallow&quot;,&quot;Traditional_fallow&quot;), # labels=c(&quot;Alfalfa&quot;, &quot;Annual&quot;, &quot;Perennial&quot;,&quot;Traditional&quot;)) guides(color = guide_legend(title = &quot;Forage fallow type&quot;))+ theme_bw()+ theme(axis.text=element_text(size=15, color=&quot;black&quot;),axis.title=element_text(size=20), legend.title=element_text(size=18),legend.text=element_text(size=18), strip.text = element_text(size = 18), axis.text.x = element_text(angle = 45, hjust = 1))#+ #theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) C_con_EROD+ scale_y_continuous(limits=c(0,2.5)) C_con_EROD "],["summary-description-and-analysis.html", "Step 4 Summary (Description and analysis) 4.1 Context of the following analysis. 4.2 Analysis looking at percentage of total soil carbon over 50 years 4.3 Using modeling and coding approach 4.4 Analyzing data with sqrt transformation 4.5 Graphing percentage of total soil carbon over 50 years", " Step 4 Summary (Description and analysis) 4.1 Context of the following analysis. #First Chapter of thesis dissertation: &quot;Exploring the sustainability of forage-based fallows in Peruvian Andean agriculture systems&quot; # In this study, the percentage of Soil total carbon was considered as one indicator to determine sustainability # I used the Daily Century ecosystem model(DayCent)(Hartman, 2018; Parton, 1996). This model was used to estimate the long-term soil C dynamics by treatment and each field locations after the introduction of forage-based fallow (tentative agro-ecological practice) within the Andean crop rotation. #This model has its own interface, which use several parameters to calculate the soil total carbon, for instance, historical soil managements, weather data, soil properties, crop rotation management, etc). # In term of historical data, this model used three scenarios to perform the equilibrium: 1. natural condition which was run for 8000 year, 2. the most common 6 year crop base rotation which was run for 200 year, and 3. current 6 crop rotation + tentative agro-ecological practice rotation which was run for 300 years. # Regarding to the tentative agro-ecological practice, it was expressed as four treatments called: 1. &quot;Traditional_fallow&quot; (control), 2. &quot;Annual fallow&quot;, 3. &quot;Perennial fallow&quot;, and 4.&quot;Alfalfa fallow&quot;. #Daycent outcomes is given per month across across 8000 year (natural conditions), 200 year (common crop rotation), and the last 300 year which account for the effect of the agro-ecological practice). #For the purpose of this study, I used the last 300 years (crop-agroecological practice). From this time frame, I only extracted data from the first 50 years to analysis the percentage of total soil carbon trend across each agro-ecological practice (treatment). library(tidyverse) # Package with dplyr, tibble, readr, and others to help clean coding library(dataRetrieval) # Package to download data library(sf) # Geospatial package to plot and explore data library(mapview) # Simple interface to leaflet interactive maps library(broom) # Simplifies model outputs library(knitr) # Makes nice tables library(kableExtra) # Makes even nicer tables library(lubridate) # Makes working with dates easier library(ggthemes) # Makes plots prettier library(tidyr) # Makes multiple simultaneous models easier library(trend) # Allows us to explore trends library(data.table) #Allows to import files quickly and conveniently library(lmerTest) library(emmeans) library(multcompView) library(multcomp) 4.2 Analysis looking at percentage of total soil carbon over 50 years #Setting working directory setwd((&quot;D:/D/DISCPO D/CSU/PHD 2023_SPRING/Enviromental data analysis/Final-Project-Submission/Carbon_trend_project&quot;)) #Binding 5 data set, each one correspond to each field, each one with four treatments (&quot;Traditional_fallow&quot; (control), 2. &quot;Annual fallow&quot;, 3. &quot;Perennial fallow&quot;, and 4.&quot;Alfalfa fallow&quot;) files&lt;-list.files(pattern = &quot;.csv&quot;) temp&lt;-lapply(files, fread, sep =&quot;,&quot;) data&lt;- rbindlist(temp, fill=TRUE) write.csv(data, file =&quot;Alldataset_carbon_stocks.csv&quot;) #Calling complete data set Carbon_trends &lt;- read.csv(&quot;D:/D/DISCPO D/CSU/PHD 2023_SPRING/Enviromental data analysis/Final-Project-Submission/Carbon_trend_project/Alldataset_carbon_stocks.csv&quot;) Carbon_trends$year&lt;- as.factor(Carbon_trends$year) #Column year customized as factor str(Carbon_trends) ## &#39;data.frame&#39;: 9360 obs. of 19 variables: ## $ X : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.1 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.2 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.3 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.4 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.5 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.6 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.7 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.8 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.9 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.10 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.11 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ V1.12 : int 1 2 3 4 5 6 7 8 9 10 ... ## $ Field : chr &quot;Dionisio&quot; &quot;Dionisio&quot; &quot;Dionisio&quot; &quot;Dionisio&quot; ... ## $ Treatment: chr &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; &quot;Traditional_fallow&quot; ... ## $ year : Factor w/ 36 levels &quot;2015&quot;,&quot;2016&quot;,..: 1 2 3 4 5 6 7 8 9 10 ... ## $ pctC : num 2.75 2.64 2.62 2.58 2.57 ... ## $ V6 : chr &quot;&quot; &quot;&quot; &quot;&quot; &quot;first cycle&quot; ... 4.3 Using modeling and coding approach #In order to understand the effect of agro-ecological practices (4 treatments) on the soil total carbon (%) after each 6 years of crop+treatments rotations. Data will be filter from 2020 to 2048 year time frame. #Assessing for normality with Shapiro test #Nesting data by year due to we want compere emmeans after 6 years of crop-agroecological practice rotation across 50 years nesting_data_SE&lt;- Carbon_trends%&gt;% filter(year %in% c(2020,2026,2032,2038, 2044,2048))%&gt;% #every 6 years group_by(year)%&gt;% #summarize(Carbon = mean(sqr, na.rm = T))%&gt;% nest() head(nesting_data_SE) ## # A tibble: 6 × 2 ## # Groups: year [6] ## year data ## &lt;fct&gt; &lt;list&gt; ## 1 2020 &lt;tibble [260 × 18]&gt; ## 2 2026 &lt;tibble [260 × 18]&gt; ## 3 2032 &lt;tibble [260 × 18]&gt; ## 4 2038 &lt;tibble [260 × 18]&gt; ## 5 2044 &lt;tibble [260 × 18]&gt; ## 6 2048 &lt;tibble [260 × 18]&gt; #Defining a function to fit the linear mixed model and perform the Shapiro-Wilk test on the residuals for each year: fit_lm_normality&lt;-function(df=nesting_data_SE){ options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;)) mod&lt;-lmer(pctC~Treatment+(1|Field), data = df) shapiro_test&lt;-shapiro.test(residuals(mod)) tibble(group = unique(df$year), lmm_result = list(mod), shapiro_wilk_statistic = shapiro_test$statistic, shapiro_wilk_p_value = shapiro_test$p.value) } #Unnesting data tidy_norm&lt;-nesting_data_SE%&gt;% mutate(results = map(data,fit_lm_normality))%&gt;% unnest(results) #Based on the Shapiro analysis our data is not normal distributed 4.4 Analyzing data with sqrt transformation #Transforming values and grouping and nesting by Year nesting_data_with_transf&lt;- Carbon_trends%&gt;% mutate(sqr=sqrt(pctC))%&gt;% filter(year %in% c(2020,2026,2032,2038, 2044,2048))%&gt;% #Every 6 years crop rotation group_by(year)%&gt;% nest() head(nesting_data_with_transf) ## # A tibble: 6 × 2 ## # Groups: year [6] ## year data ## &lt;fct&gt; &lt;list&gt; ## 1 2020 &lt;tibble [260 × 19]&gt; ## 2 2026 &lt;tibble [260 × 19]&gt; ## 3 2032 &lt;tibble [260 × 19]&gt; ## 4 2038 &lt;tibble [260 × 19]&gt; ## 5 2044 &lt;tibble [260 × 19]&gt; ## 6 2048 &lt;tibble [260 × 19]&gt; #Creating the function for the MODEL fit_lm_anova_SE&lt;-function(df=nesting_data_with_transf[[1]]){ options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;)) mod&lt;-lmer(sqr~Treatment+(1|Field), data = df) Anova&lt;-anova(mod, ddf=&quot;Kenward-Roger&quot;) } #Tiding and unnesting the model tidy_ANOVA_SE&lt;-nesting_data_with_transf%&gt;% mutate(tidy_mod = map(data,fit_lm_anova_SE))%&gt;% unnest(tidy_mod) view(tidy_ANOVA_SE) #we can use .key=&quot;rename data columns&quot; #summarize(Carbon = mean(sqr, na.rm = T))%&gt;% 4.5 Graphing percentage of total soil carbon over 50 years #Summarizing data set summary_C&lt;- Carbon_trends%&gt;% group_by(Treatment, year)%&gt;% summarise( n=n(), mean=mean(pctC), sd=sd(pctC), se=sd/sqrt(n)) summary_C ## # A tibble: 144 × 6 ## # Groups: Treatment [4] ## Treatment year n mean sd se ## &lt;chr&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Alfalfa fallow 2015 65 1.85 0.498 0.0617 ## 2 Alfalfa fallow 2016 65 1.83 0.458 0.0568 ## 3 Alfalfa fallow 2017 65 1.79 0.462 0.0573 ## 4 Alfalfa fallow 2018 65 1.76 0.445 0.0552 ## 5 Alfalfa fallow 2019 65 1.76 0.437 0.0542 ## 6 Alfalfa fallow 2020 65 2.06 0.382 0.0474 ## 7 Alfalfa fallow 2021 65 2.00 0.385 0.0478 ## 8 Alfalfa fallow 2022 65 1.92 0.366 0.0454 ## 9 Alfalfa fallow 2023 65 1.87 0.368 0.0456 ## 10 Alfalfa fallow 2024 65 1.85 0.359 0.0445 ## # … with 134 more rows #Graph Carbon trends data_new &lt;- summary_C # Duplicate data levels(data_new$Treatment) &lt;- list(&quot;Alfalfa&quot; = &quot;Alfalfa fallow&quot;, # Change factor levels &quot;Annual&quot; = &quot;Annual fallow&quot;, &quot;Perennial&quot; = &quot;Perennial fallow&quot;, &quot;Traditional&quot; = &quot;Traditional_fallow&quot;) C_con_EROD&lt;-ggplot(data_new, aes(year, mean,group=Treatment, color=Treatment)) + xlab(&quot;&quot;) + ylab(&quot;% Soil total carbon&quot;)+ geom_line() + geom_point(size=1)+ # scale_shape_discrete(name=&quot;Fallow type&quot;, # breaks=c(&quot;Alfalfa fallow&quot;,&quot;Annual fallow&quot;, &quot;Perennial fallow&quot;,&quot;Traditional_fallow&quot;), # labels=c(&quot;Alfalfa&quot;, &quot;Annual&quot;, &quot;Perennial&quot;,&quot;Traditional&quot;)) guides(color = guide_legend(title = &quot;Forage fallow type&quot;))+ theme_bw()+ theme(axis.text=element_text(size=15, color=&quot;black&quot;),axis.title=element_text(size=20), legend.title=element_text(size=18),legend.text=element_text(size=18), strip.text = element_text(size = 18), axis.text.x = element_text(angle = 45, hjust = 1))#+ #theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) C_con_EROD+ scale_y_continuous(limits=c(0,2.5)) C_con_EROD "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
